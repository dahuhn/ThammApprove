{"level":"error","message":"Failed to start server: SQLITE_ERROR: no such column: jobId","name":"SequelizeDatabaseError","original":{"code":"SQLITE_ERROR","errno":1,"sql":"CREATE INDEX `approvals_job_id` ON `approvals` (`jobId`)"},"parameters":{},"parent":{"code":"SQLITE_ERROR","errno":1,"sql":"CREATE INDEX `approvals_job_id` ON `approvals` (`jobId`)"},"sql":"CREATE INDEX `approvals_job_id` ON `approvals` (`jobId`)","stack":"Error\n    at Database.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:236:27)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:50)\n    at new Promise (<anonymous>)\n    at Query.run (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:12)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:650:28)\n    at async SQLiteQueryInterface.addIndex (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:586:12)\n    at async Function.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\model.js:1427:7)\n    at async Sequelize.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:825:9)\n    at async startServer (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\index.ts:46:5)","timestamp":"2025-09-24 15:11:34"}
{"level":"error","message":"Failed to start server: SQLITE_ERROR: Cannot add a UNIQUE column","name":"SequelizeDatabaseError","original":{"code":"SQLITE_ERROR","errno":1,"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;"},"parameters":{},"parent":{"code":"SQLITE_ERROR","errno":1,"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;"},"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;","stack":"Error\n    at Database.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:236:27)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:50)\n    at new Promise (<anonymous>)\n    at Query.run (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:12)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:650:28)\n    at async SQLiteQueryInterface.addColumn (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:430:12)\n    at async Function.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\model.js:1373:11)\n    at async Sequelize.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:825:9)\n    at async startServer (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\index.ts:46:5)","timestamp":"2025-09-24 15:12:42"}
{"level":"error","message":"Failed to start server: SQLITE_ERROR: Cannot add a UNIQUE column","name":"SequelizeDatabaseError","original":{"code":"SQLITE_ERROR","errno":1,"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;"},"parameters":{},"parent":{"code":"SQLITE_ERROR","errno":1,"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;"},"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;","stack":"Error\n    at Database.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:236:27)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:50)\n    at new Promise (<anonymous>)\n    at Query.run (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:12)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:650:28)\n    at async SQLiteQueryInterface.addColumn (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:430:12)\n    at async Function.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\model.js:1373:11)\n    at async Sequelize.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:825:9)\n    at async startServer (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\index.ts:46:5)","timestamp":"2025-09-24 15:12:48"}
{"level":"error","message":"Failed to start server: SQLITE_ERROR: Cannot add a UNIQUE column","name":"SequelizeDatabaseError","original":{"code":"SQLITE_ERROR","errno":1,"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;"},"parameters":{},"parent":{"code":"SQLITE_ERROR","errno":1,"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;"},"sql":"ALTER TABLE `approvals` ADD `jobId` VARCHAR(255) NOT NULL UNIQUE;","stack":"Error\n    at Database.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:236:27)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:50)\n    at new Promise (<anonymous>)\n    at Query.run (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\sqlite\\query.js:234:12)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:650:28)\n    at async SQLiteQueryInterface.addColumn (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:430:12)\n    at async Function.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\model.js:1373:11)\n    at async Sequelize.sync (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\sequelize.js:825:9)\n    at async startServer (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\index.ts:46:5)","timestamp":"2025-09-24 15:13:44"}
{"code":"LIMIT_UNEXPECTED_FILE","field":"file","level":"error","message":"Unexpected field","name":"MulterError","stack":"MulterError: Unexpected field\n    at wrappedFileFilter (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\multer\\index.js:40:19)\n    at Multipart.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\multer\\lib\\make-middleware.js:109:7)\n    at Multipart.emit (node:events:519:28)\n    at HeaderParser.cb (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:358:14)\n    at HeaderParser.push (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:162:20)\n    at SBMH.ssCb [as _cb] (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:394:37)\n    at feed (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\streamsearch\\lib\\sbmh.js:248:10)\n    at SBMH.push (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\streamsearch\\lib\\sbmh.js:104:16)\n    at Multipart._write (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:572:12)","storageErrors":[],"timestamp":"2025-09-25 19:26:41"}
{"code":"LIMIT_UNEXPECTED_FILE","field":"file","level":"error","message":"Unexpected field","name":"MulterError","stack":"MulterError: Unexpected field\n    at wrappedFileFilter (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\multer\\index.js:40:19)\n    at Multipart.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\multer\\lib\\make-middleware.js:109:7)\n    at Multipart.emit (node:events:519:28)\n    at HeaderParser.cb (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:358:14)\n    at HeaderParser.push (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:162:20)\n    at SBMH.ssCb [as _cb] (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:394:37)\n    at feed (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\streamsearch\\lib\\sbmh.js:248:10)\n    at SBMH.push (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\streamsearch\\lib\\sbmh.js:104:16)\n    at Multipart._write (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:572:12)","storageErrors":[],"timestamp":"2025-09-25 19:27:44"}
{"code":"LIMIT_UNEXPECTED_FILE","field":"file","level":"error","message":"Unexpected field","name":"MulterError","stack":"MulterError: Unexpected field\n    at wrappedFileFilter (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\multer\\index.js:40:19)\n    at Multipart.<anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\multer\\lib\\make-middleware.js:109:7)\n    at Multipart.emit (node:events:519:28)\n    at HeaderParser.cb (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:358:14)\n    at HeaderParser.push (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:162:20)\n    at SBMH.ssCb [as _cb] (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:394:37)\n    at feed (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\streamsearch\\lib\\sbmh.js:248:10)\n    at SBMH.push (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\streamsearch\\lib\\sbmh.js:104:16)\n    at Multipart._write (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\busboy\\lib\\types\\multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:572:12)","storageErrors":[],"timestamp":"2025-09-25 19:29:09"}
{"level":"error","message":"Error creating approval: Cannot read properties of undefined (reading 'toLocaleDateString')","stack":"TypeError: Cannot read properties of undefined (reading 'toLocaleDateString')\n    at sendApprovalEmail (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\services\\email.service.ts:54:144)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\routes\\approval.routes.ts:93:11)","timestamp":"2025-09-25 19:31:33"}
{"fileInfo":{"fieldname":"file","filename":"3609211e-3bbc-4087-8e77-63b5e2ea1ed2-_00001_Les Essarts 25-26 Flyer.pdf","path":"..\\uploads\\3609211e-3bbc-4087-8e77-63b5e2ea1ed2-_00001_Les Essarts 25-26 Flyer.pdf","size":4939892},"files":[{"destination":"../uploads","encoding":"7bit","fieldname":"file","filename":"3609211e-3bbc-4087-8e77-63b5e2ea1ed2-_00001_Les Essarts 25-26 Flyer.pdf","mimetype":"application/pdf","originalname":"_00001_Les Essarts 25-26 Flyer.pdf","path":"..\\uploads\\3609211e-3bbc-4087-8e77-63b5e2ea1ed2-_00001_Les Essarts 25-26 Flyer.pdf","size":4939892}],"level":"error","message":"Cannot read properties of undefined (reading 'toLocaleDateString')","requestBody":{"customerEmail":"d.huhn@thamm.de","customerName":"Daniel Huhn","fileName":"Les Essarts 25-26 Flyer.pdf","jobId":"Les Essarts 25-26 Flyer.pdf_1758821943938","metadata":"{\"fileName\":\"Les Essarts 25-26 Flyer.pdf\",\"originalPath\":\"C:/Users/switch/AppData/Local/Temp/FixtureTest00/inFolder2/_00001_Les Essarts 25-26 Flyer.pdf\",\"submitTime\":\"2025-09-25T19:39:03Z\"}"},"stack":"TypeError: Cannot read properties of undefined (reading 'toLocaleDateString')\n    at sendApprovalEmail (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\services\\email.service.ts:54:144)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\routes\\approval.routes.ts:93:11)","timestamp":"2025-09-25 19:39:04"}
{"fileInfo":{"fieldname":"file","filename":"f1861d92-1619-4d70-9492-eba9293f6681-_00001_Les Essarts 25-26 Flyer.pdf","path":"..\\uploads\\f1861d92-1619-4d70-9492-eba9293f6681-_00001_Les Essarts 25-26 Flyer.pdf","size":4939892},"files":[{"destination":"../uploads","encoding":"7bit","fieldname":"file","filename":"f1861d92-1619-4d70-9492-eba9293f6681-_00001_Les Essarts 25-26 Flyer.pdf","mimetype":"application/pdf","originalname":"_00001_Les Essarts 25-26 Flyer.pdf","path":"..\\uploads\\f1861d92-1619-4d70-9492-eba9293f6681-_00001_Les Essarts 25-26 Flyer.pdf","size":4939892}],"level":"error","message":"WHERE parameter \"jobId\" has invalid \"undefined\" value","requestBody":{"customerEmail":"d.huhn@thamm.de","customerName":"Daniel Huhn","fileName":"Les Essarts 25-26 Flyer.pdf","jobId":"Les Essarts 25-26 Flyer.pdf_1758822074251","metadata":"{\"fileName\":\"Les Essarts 25-26 Flyer.pdf\",\"originalPath\":\"C:/Users/switch/AppData/Local/Temp/FixtureTest00/inFolder2/_00001_Les Essarts 25-26 Flyer.pdf\",\"submitTime\":\"2025-09-25T19:41:14Z\"}"},"stack":"Error: WHERE parameter \"jobId\" has invalid \"undefined\" value\n    at SQLiteQueryGenerator.whereItemQuery (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-generator.js:2451:13)\n    at <anonymous> (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-generator.js:2440:25)\n    at Array.forEach (<anonymous>)\n    at SQLiteQueryGenerator.whereItemsQuery (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-generator.js:2438:35)\n    at SQLiteQueryGenerator.getWhereConditions (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-generator.js:2866:19)\n    at SQLiteQueryGenerator.selectQuery (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-generator.js:1466:28)\n    at SQLiteQueryInterface.select (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\dialects\\abstract\\query-interface.js:1002:27)\n    at Function.findAll (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\model.js:1824:47)\n    at async Function.findOne (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\node_modules\\sequelize\\src\\model.js:1998:12)\n    at async getApproval (C:\\Users\\dhuhn\\PyProjects\\ThammApprove\\backend\\src\\services\\approval.service.ts:48:10)","timestamp":"2025-09-25 19:41:14"}
{"address":"127.0.0.1","code":"ESOCKET","command":"CONN","errno":-4078,"level":"error","message":"Failed to send approval email: connect ECONNREFUSED 127.0.0.1:587","port":587,"stack":"Error: connect ECONNREFUSED 127.0.0.1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)","syscall":"connect","timestamp":"2025-09-25 19:42:11"}
{"fileInfo":{"fieldname":"file","filename":"a260492f-aea4-437e-b847-3e8e1f30c4bf-_00001_Les Essarts 25-26 Flyer.pdf","path":"..\\uploads\\a260492f-aea4-437e-b847-3e8e1f30c4bf-_00001_Les Essarts 25-26 Flyer.pdf","size":4939892},"files":[{"destination":"../uploads","encoding":"7bit","fieldname":"file","filename":"a260492f-aea4-437e-b847-3e8e1f30c4bf-_00001_Les Essarts 25-26 Flyer.pdf","mimetype":"application/pdf","originalname":"_00001_Les Essarts 25-26 Flyer.pdf","path":"..\\uploads\\a260492f-aea4-437e-b847-3e8e1f30c4bf-_00001_Les Essarts 25-26 Flyer.pdf","size":4939892}],"level":"error","message":"connect ECONNREFUSED 127.0.0.1:587","requestBody":{"customerEmail":"d.huhn@thamm.de","customerName":"Daniel Huhn","fileName":"Les Essarts 25-26 Flyer.pdf","jobId":"Les Essarts 25-26 Flyer.pdf_1758822130958","metadata":"{\"fileName\":\"Les Essarts 25-26 Flyer.pdf\",\"originalPath\":\"C:/Users/switch/AppData/Local/Temp/FixtureTest00/inFolder2/_00001_Les Essarts 25-26 Flyer.pdf\",\"submitTime\":\"2025-09-25T19:42:10Z\"}"},"stack":"Error: connect ECONNREFUSED 127.0.0.1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)","timestamp":"2025-09-25 19:42:11"}
{"address":"127.0.0.1","code":"ESOCKET","command":"CONN","errno":-4078,"level":"error","message":"Failed to send approval email: connect ECONNREFUSED 127.0.0.1:587","port":587,"stack":"Error: connect ECONNREFUSED 127.0.0.1:587\n    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1637:16)","syscall":"connect","timestamp":"2025-09-25 19:45:07"}
{"error":"connect ECONNREFUSED 127.0.0.1:587","level":"error","message":"Failed to send approval email:","smtpConfig":{"host":"mail.thamm.de","port":"587","user":"thamm\\switch"},"timestamp":"2025-09-25 19:52:12"}
{"error":"connect ECONNREFUSED 127.0.0.1:587","jobId":"Les Essarts 25-26 Flyer.pdf_1758823202179","level":"error","message":"Failed to send approval email:","smtpConfig":{"host":"mail.thamm.de","port":"587","user":"thamm\\switch"},"timestamp":"2025-09-25 20:00:02","to":"d.huhn@thamm.de"}
{"error":"connect ECONNREFUSED 127.0.0.1:587","jobId":"Les Essarts 25-26 Flyer.pdf_1758823314844","level":"error","message":"Failed to send approval email:","smtpConfig":{"host":"mail.thamm.de","port":"587","user":"thamm\\switch"},"timestamp":"2025-09-25 20:01:54","to":"d.huhn@thamm.de"}
{"actualTransporterConfig":{"host":"mail.thamm.de","port":587,"user":"thamm\\switch"},"error":"Message failed: 550 5.7.60 SMTP; Client does not have permissions to send as this sender","jobId":"Les Essarts 25-26 Flyer.pdf_1758823624550","level":"error","message":"Failed to send approval email:","smtpConfig":{"host":"mail.thamm.de","port":"587","user":"thamm\\switch"},"timestamp":"2025-09-25 20:07:05","to":"d.huhn@thamm.de"}
{"actualTransporterConfig":{"host":"mail.thamm.de","port":587,"user":"thamm\\switch"},"error":"Message failed: 550 5.7.60 SMTP; Client does not have permissions to send as this sender","jobId":"Les Essarts 25-26 Flyer.pdf_1758823683680","level":"error","message":"Failed to send approval email:","smtpConfig":{"host":"mail.thamm.de","port":"587","user":"thamm\\switch"},"timestamp":"2025-09-25 20:08:04","to":"d.huhn@thamm.de"}
